
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Anexo: ejercicios sobre XSLT &#8212; Apuntes de Lenguajes de Marcas v1.3</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Anexo: Ejercicios de XPath" href="../xpath/anexo_ejercicios_xpath.html" />
    <link rel="prev" title="Anexo: ejercicios sobre formularios" href="../formularios/anexo_formularios.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="anexo-ejercicios-sobre-xslt">
<h1>Anexo: ejercicios sobre XSLT<a class="headerlink" href="#anexo-ejercicios-sobre-xslt" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="fichero-origen">
<h2>Fichero origen<a class="headerlink" href="#fichero-origen" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para los ejercicios siguiente supondremos que se va a trabajar con el fichero que se muestra a continuación:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;inventario&gt;</span>
    <span class="nt">&lt;producto</span> <span class="na">codigo=</span><span class="s">&quot;P1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;peso</span> <span class="na">unidad=</span><span class="s">&quot;kg&quot;</span><span class="nt">&gt;</span>10<span class="nt">&lt;/peso&gt;</span>
        <span class="nt">&lt;nombre&gt;</span>Ordenador<span class="nt">&lt;/nombre&gt;</span>
        <span class="nt">&lt;lugar</span> <span class="na">edificio=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;aula&gt;</span>10<span class="nt">&lt;/aula&gt;</span>
        <span class="nt">&lt;/lugar&gt;</span>
    <span class="nt">&lt;/producto&gt;</span>
    <span class="nt">&lt;producto</span> <span class="na">codigo=</span><span class="s">&quot;P2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;peso</span> <span class="na">unidad=</span><span class="s">&#39;g&#39;</span><span class="nt">&gt;</span>500<span class="nt">&lt;/peso&gt;</span>
        <span class="nt">&lt;nombre&gt;</span>Switch<span class="nt">&lt;/nombre&gt;</span>
        <span class="nt">&lt;lugar</span> <span class="na">edificio=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;aula&gt;</span>6<span class="nt">&lt;/aula&gt;</span>
        <span class="nt">&lt;/lugar&gt;</span>
    <span class="nt">&lt;/producto&gt;</span>
<span class="nt">&lt;/inventario&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="generacion-de-lista-con-puntos">
<h2>Generación de lista con puntos<a class="headerlink" href="#generacion-de-lista-con-puntos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Convertir el fichero origen en una lista punteada similar a la que se muestra en la figura:</p>
<a class="reference internal image-reference" href="../../_images/lista_punteada.png"><img alt="../../_images/lista_punteada.png" class="align-center" src="../../_images/lista_punteada.png" style="width: 308.5px; height: 198.5px;" /></a>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;html&gt;</span>
        <span class="nt">&lt;head&gt;</span>
            <span class="nt">&lt;title&gt;</span>Resultado HTML<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;/head&gt;</span>
        <span class="nt">&lt;body&gt;</span>
            <span class="nt">&lt;ul&gt;</span>
                <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;li&gt;</span>
                        Elemento
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;./@codigo&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;ul&gt;</span>
                            <span class="nt">&lt;li&gt;</span>
                                Nombre:
                                <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/li&gt;</span>
                            <span class="nt">&lt;li&gt;</span>
                                Peso:
                                <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;peso&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;xsl:value-of</span>
                                    <span class="na">select=</span><span class="s">&quot;peso/@unidad&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/li&gt;</span>
                        <span class="nt">&lt;/ul&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                <span class="nt">&lt;/xsl:for-each&gt;</span>
            <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="recuperacion-de-elementos-pesados">
<h2>Recuperación de elementos pesados<a class="headerlink" href="#recuperacion-de-elementos-pesados" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se pide un XSLT que muestre exactamente la misma información del fichero origen pero sin mostrar los elementos cuyo peso sea menor de 7.</p>
<p>Una posible solución sería esta:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
 <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;inventario&gt;</span>
    <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;peso &amp;lt; 7&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;producto&gt;</span>
                <span class="nt">&lt;peso&gt;</span>
                    <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;peso&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/peso&gt;</span>
                <span class="nt">&lt;nombre&gt;</span>
                    <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/nombre&gt;</span>
                <span class="nt">&lt;lugar&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;edificio&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/@edificio&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="nt">&lt;aula&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/aula&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/aula&gt;</span>
                <span class="nt">&lt;/lugar&gt;</span>
            <span class="nt">&lt;/producto&gt;</span>
        <span class="nt">&lt;/xsl:if&gt;</span>
    <span class="nt">&lt;/xsl:for-each&gt;</span>
    <span class="nt">&lt;/inventario&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="productos-del-edificio-b">
<h2>Productos del edificio B<a class="headerlink" href="#productos-del-edificio-b" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se pide ahora mostrar en el resultado la misma información del fichero origen pero solo en los casos en que el lugar del producto sea el edificio B</p>
<p>La solución es muy parecida, necesitando solamente modificar la condición.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
 <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;inventario&gt;</span>
    <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;lugar/@edificio=&#39;B&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;producto&gt;</span>
                <span class="nt">&lt;peso&gt;</span>
                    <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;peso&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/peso&gt;</span>
                <span class="nt">&lt;nombre&gt;</span>
                    <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/nombre&gt;</span>
                <span class="nt">&lt;lugar&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;edificio&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/@edificio&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="nt">&lt;aula&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/aula&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/aula&gt;</span>
                <span class="nt">&lt;/lugar&gt;</span>
            <span class="nt">&lt;/producto&gt;</span>
        <span class="nt">&lt;/xsl:if&gt;</span>
    <span class="nt">&lt;/xsl:for-each&gt;</span>
    <span class="nt">&lt;/inventario&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="tabla-de-localizaciones">
<h2>Tabla de localizaciones<a class="headerlink" href="#tabla-de-localizaciones" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Generar una tabla HTML que muestre la información del fichero origen de la manera siguiente:</p>
<a class="reference internal image-reference" href="../../_images/xslt_tabla_edificio_aula.png"><img alt="../../_images/xslt_tabla_edificio_aula.png" class="align-center" src="../../_images/xslt_tabla_edificio_aula.png" style="width: 241.5px; height: 214.0px;" /></a>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
 <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;inventario&gt;</span>
    <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;lugar/@edificio=&#39;B&#39;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;producto&gt;</span>
                <span class="nt">&lt;peso&gt;</span>
                    <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;peso&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/peso&gt;</span>
                <span class="nt">&lt;nombre&gt;</span>
                    <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/nombre&gt;</span>
                <span class="nt">&lt;lugar&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;edificio&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/@edificio&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="nt">&lt;aula&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/aula&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/aula&gt;</span>
                <span class="nt">&lt;/lugar&gt;</span>
            <span class="nt">&lt;/producto&gt;</span>
        <span class="nt">&lt;/xsl:if&gt;</span>
    <span class="nt">&lt;/xsl:for-each&gt;</span>
    <span class="nt">&lt;/inventario&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="tablas-con-edificios-separados">
<h2>Tablas con edificios separados<a class="headerlink" href="#tablas-con-edificios-separados" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hacer una plantilla que fabrique una tabla
con los datos de los productos del edificio A
y otra tabla separada para los productos del edificio B</p>
<a class="reference internal image-reference" href="../../_images/xslt_tabla_edificio_separadas.png"><img alt="../../_images/xslt_tabla_edificio_separadas.png" class="align-center" src="../../_images/xslt_tabla_edificio_separadas.png" style="width: 163.5px; height: 229.0px;" /></a>
<p>Una posible solución sería esta:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
<span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;html&gt;</span>
        <span class="nt">&lt;head&gt;&lt;title&gt;</span>Datos por edificio<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
        <span class="nt">&lt;body&gt;</span>
            <span class="nt">&lt;h1&gt;</span>Edificio A<span class="nt">&lt;/h1&gt;</span>
            <span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&#39;1&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;lugar/@edificio=&#39;A&#39;&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;tr&gt;</span>
                        <span class="nt">&lt;td&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                                <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;td&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                                <span class="na">select=</span><span class="s">&quot;peso&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;td&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/@edificio&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/aula&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;/tr&gt;</span>
                <span class="nt">&lt;/xsl:if&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
            <span class="nt">&lt;/table&gt;</span>
            <span class="nt">&lt;h1&gt;</span>Edificio B<span class="nt">&lt;/h1&gt;</span>
            <span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&#39;1&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;lugar/@edificio=&#39;B&#39;&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;tr&gt;</span>
                        <span class="nt">&lt;td&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                                <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;td&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                                <span class="na">select=</span><span class="s">&quot;peso&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;td&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/@edificio&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;xsl:value-of</span>
                            <span class="na">select=</span><span class="s">&quot;lugar/aula&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;/tr&gt;</span>
                <span class="nt">&lt;/xsl:if&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
            <span class="nt">&lt;/table&gt;</span>
        <span class="nt">&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="productos-del-aula-6">
<h2>Productos del aula 6<a class="headerlink" href="#productos-del-aula-6" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se pide generar un inventario en el que aparezcan solo los nombres de productos que estén en el aula 6.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
  <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;inventario&gt;</span>
  <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;/inventario/producto&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot; lugar/aula= &#39;6&#39; &quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;nombre&gt;</span>
        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/nombre&gt;</span>
    <span class="nt">&lt;/xsl:if&gt;</span>
  <span class="nt">&lt;/xsl:for-each&gt;</span>
  <span class="nt">&lt;/inventario&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Productos del edificio B<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El siguiente ejercicio es muy parecido al anterior, con la salvedad de que ahora solo nos piden los nombres de los productos ubicados en el edificio B.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;inventario&gt;</span>
  <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;/inventario/producto&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot; lugar/@edificio = &#39;B&#39; &quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;nombre&gt;</span>
        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/nombre&gt;</span>
    <span class="nt">&lt;/xsl:if&gt;</span>
  <span class="nt">&lt;/xsl:for-each&gt;</span>
  <span class="nt">&lt;/inventario&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="condiciones-multiples-peso-ligero-y-edificio-a">
<h2>Condiciones múltiples: peso ligero y edificio A<a class="headerlink" href="#condiciones-multiples-peso-ligero-y-edificio-a" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se pide ahora generar un fichero HTML con una tabla pero en la que solo aparezcan los productos cuyo edificio sea el A <strong>y además</strong> pesen menos de 7kg.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
<span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;html&gt;</span>
        <span class="nt">&lt;head&gt;&lt;title&gt;</span>Resultados<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
        <span class="nt">&lt;body&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;inventario/producto&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;lugar/@edificio = &#39;A&#39;&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;peso/@unidad = &#39;g&#39;&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;peso &amp;lt; 7000&quot;</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;tr&gt;</span>
                                <span class="nt">&lt;td&gt;</span>
                                    <span class="nt">&lt;xsl:value-of</span>
                                    <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;/tr&gt;</span>
                        <span class="nt">&lt;/xsl:if&gt;</span>
                    <span class="nt">&lt;/xsl:if&gt;</span>
                    <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;peso/@unidad = &#39;Kg&#39;&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;peso &amp;lt; 7&quot;</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;tr&gt;</span>
                                <span class="nt">&lt;td&gt;</span>
                                    <span class="nt">&lt;xsl:value-of</span>
                                    <span class="na">select=</span><span class="s">&quot;nombre&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;/tr&gt;</span>
                        <span class="nt">&lt;/xsl:if&gt;</span>
                    <span class="nt">&lt;/xsl:if&gt;</span>
                <span class="nt">&lt;/xsl:if&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="ejercicio-de-examen-xslt">
<h2>Ejercicio de examen XSLT<a class="headerlink" href="#ejercicio-de-examen-xslt" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Dado el siguiente fichero XML</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;catalogo&gt;</span>
  <span class="nt">&lt;libro</span> <span class="na">isbn=</span><span class="s">&quot;i1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;titulo&gt;</span>Don Quijote<span class="nt">&lt;/titulo&gt;</span>
    <span class="nt">&lt;autores&gt;</span>
      <span class="nt">&lt;autor</span> <span class="na">nacimiento=</span><span class="s">&quot;1547&quot;</span><span class="nt">&gt;</span>Cervantes<span class="nt">&lt;/autor&gt;</span>
    <span class="nt">&lt;/autores&gt;</span>
  <span class="nt">&lt;/libro&gt;</span>
  <span class="nt">&lt;libro</span> <span class="na">isbn=</span><span class="s">&quot;i2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;titulo&gt;</span>Antologia<span class="nt">&lt;/titulo&gt;</span>
    <span class="nt">&lt;autores&gt;</span>
        <span class="nt">&lt;autor</span> <span class="na">nacimiento=</span><span class="s">&quot;1898&quot;</span><span class="nt">&gt;</span>Lorca<span class="nt">&lt;/autor&gt;</span>
        <span class="nt">&lt;autor</span> <span class="na">nacimiento=</span><span class="s">&quot;1910&quot;</span><span class="nt">&gt;</span>Miguel Hernandez<span class="nt">&lt;/autor&gt;</span>
    <span class="nt">&lt;/autores&gt;</span>
  <span class="nt">&lt;/libro&gt;</span>
<span class="nt">&lt;/catalogo&gt;</span>
</pre></div>
</div>
<p>Conseguir lo siguiente:</p>
<ol class="arabic simple">
<li>Mostrar en un HTML con lista numerada los títulos de los libros con algún autor nacido despues de 1900.</li>
</ol>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet&gt;</span>
    No se da la solución de este
    ejercicio
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Mostrar en un HTML la lista de los autores ordenada por orden alfabético inverso.</li>
</ol>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet&gt;</span>
    No se da la solución de este
    ejercicio
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Mostrar el nombre de los autores nacidos despues del año 1700.</li>
</ol>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span>
<span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;html&gt;</span>
        <span class="nt">&lt;head&gt;&lt;title&gt;</span>Resultado<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
        <span class="nt">&lt;body&gt;</span>
            <span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">&#39;1&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;tr&gt;</span>
                    <span class="nt">&lt;td&gt;</span>Nombre<span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;</span>Año nacimiento<span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;/tr&gt;</span>
                <span class="nt">&lt;xsl:for-each</span>
                <span class="na">select=</span><span class="s">&quot;catalogo/libro/autores/autor&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:if</span> <span class="na">test=</span><span class="s">&quot;@nacimiento &amp;gt; 1700&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;td&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;.&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;@nacimiento&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;/xsl:if&gt;</span>
                <span class="nt">&lt;/xsl:for-each&gt;</span>
            <span class="nt">&lt;/table&gt;</span>
        <span class="nt">&lt;/body&gt;</span>
    <span class="nt">&lt;/html&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="transformacion-de-un-xml-bancario">
<h2>Transformación de un XML bancario<a class="headerlink" href="#transformacion-de-un-xml-bancario" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Una empresa utiliza el siguiente XML para intercambiar información entre bases de datos de distintos proveedores. Sin embargo han comprado un nuevo sistema que necesita que la información tenga una estructura siguiente. Los dos listados que se ven a continuación ilustran la estructura original y la nueva estructura que deben tener los datos. Crear el XSLT que permita convertir la información original en un formato que pueda entender el nuevo sistema.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!--Estructura original de la información--&gt;</span>
<span class="nt">&lt;listado&gt;</span>
    <span class="nt">&lt;cuenta&gt;</span>
        <span class="nt">&lt;titular</span> <span class="na">dni=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">&gt;</span>Ramon Perez<span class="nt">&lt;/titular&gt;</span>
        <span class="nt">&lt;saldoactual</span> <span class="na">moneda=</span><span class="s">&quot;euros&quot;</span><span class="nt">&gt;</span>12000<span class="nt">&lt;/saldoactual&gt;</span>
        <span class="nt">&lt;fechacreacion&gt;</span>13-abril-2012<span class="nt">&lt;/fechacreacion&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
    <span class="nt">&lt;fondo&gt;</span>
        <span class="nt">&lt;cuentaasociada&gt;</span>20-A<span class="nt">&lt;/cuentaasociada&gt;</span>
        <span class="nt">&lt;datos&gt;</span>
            <span class="nt">&lt;cantidaddepositada&gt;</span>20000<span class="nt">&lt;/cantidaddepositada&gt;</span>
            <span class="nt">&lt;moneda&gt;</span>Euros<span class="nt">&lt;/moneda&gt;</span>
        <span class="nt">&lt;/datos&gt;</span>
    <span class="nt">&lt;/fondo&gt;</span>
    <span class="nt">&lt;fondo&gt;</span>
        <span class="nt">&lt;cuentaasociada&gt;</span>21-DX<span class="nt">&lt;/cuentaasociada&gt;</span>
        <span class="nt">&lt;datos&gt;</span>
            <span class="nt">&lt;cantidaddepositada&gt;</span>4800<span class="nt">&lt;/cantidaddepositada&gt;</span>
            <span class="nt">&lt;moneda&gt;</span>Dolares<span class="nt">&lt;/moneda&gt;</span>
        <span class="nt">&lt;/datos&gt;</span>
    <span class="nt">&lt;/fondo&gt;</span>
    <span class="nt">&lt;cuenta&gt;</span>
        <span class="nt">&lt;titular</span> <span class="na">dni=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">&gt;</span>Carmen Diaz<span class="nt">&lt;/titular&gt;</span>
        <span class="nt">&lt;saldoactual</span> <span class="na">moneda=</span><span class="s">&quot;euros&quot;</span><span class="nt">&gt;</span>1900<span class="nt">&lt;/saldoactual&gt;</span>
        <span class="nt">&lt;fechacreacion&gt;</span>15-febrero-2011<span class="nt">&lt;/fechacreacion&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
<span class="nt">&lt;/listado&gt;</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!--Estructura final que debemos conseguir--&gt;</span>
<span class="nt">&lt;datos&gt;</span>
    <span class="nt">&lt;cuentas&gt;</span>
        <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;creacion&gt;</span>13-abril-2012<span class="nt">&lt;/creacion&gt;</span>
            <span class="nt">&lt;titular&gt;</span>Ramon Perez<span class="nt">&lt;/titular&gt;</span>
            <span class="nt">&lt;saldoactual&gt;</span>12000 euros<span class="nt">&lt;/saldoactual&gt;</span>

        <span class="nt">&lt;/cuenta&gt;</span>
        <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;creacion&gt;</span>15-febrero-2011<span class="nt">&lt;/creacion&gt;</span>
            <span class="nt">&lt;titular&gt;</span>Carmen Diaz<span class="nt">&lt;/titular&gt;</span>
            <span class="nt">&lt;saldoactual&gt;</span>1900 euros<span class="nt">&lt;/saldoactual&gt;</span>

        <span class="nt">&lt;/cuenta&gt;</span>
    <span class="nt">&lt;/cuentas&gt;</span>
    <span class="nt">&lt;fondos&gt;</span>
        <span class="nt">&lt;fondo</span> <span class="na">cuentaasociada=</span><span class="s">&quot;20-A&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;cantidaddepositada&gt;</span>20000<span class="nt">&lt;/cantidaddepositada&gt;</span>
            <span class="nt">&lt;moneda&gt;</span>Euros<span class="nt">&lt;/moneda&gt;</span>
        <span class="nt">&lt;/fondo&gt;</span>
        <span class="nt">&lt;fondo</span> <span class="na">cuentaasociada=</span><span class="s">&quot;21-DX&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;cantidaddepositada&gt;</span>4800<span class="nt">&lt;/cantidaddepositada&gt;</span>
            <span class="nt">&lt;moneda&gt;</span>Dolares<span class="nt">&lt;/moneda&gt;</span>
        <span class="nt">&lt;/fondo&gt;</span>
    <span class="nt">&lt;/fondos&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
<div class="section" id="analisis-del-problema">
<h3>Análisis del problema<a class="headerlink" href="#analisis-del-problema" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Es necesario hacer varios cambios:</p>
<ol class="arabic simple">
<li>Se ha cambiado el nombre de elemento raíz de <code class="docutils literal"><span class="pre">listado</span></code> a <code class="docutils literal"><span class="pre">datos</span></code>.</li>
<li>Ahora todos los elementos <code class="docutils literal"><span class="pre">cuenta</span></code> van dentro de un nuevo elemento <code class="docutils literal"><span class="pre">cuentas</span></code> y todos los elementos <code class="docutils literal"><span class="pre">fondo</span></code> van dentro de un nuevo elemento <code class="docutils literal"><span class="pre">fondos</span></code>.</li>
<li>El <code class="docutils literal"><span class="pre">dni</span></code> se ha movido del elemento <code class="docutils literal"><span class="pre">titular</span></code> al elemento <code class="docutils literal"><span class="pre">cuenta</span></code>.</li>
<li>La <code class="docutils literal"><span class="pre">fechacreación</span></code> se ha movido y se ha renombrado a <code class="docutils literal"><span class="pre">creacion</span></code>.</li>
<li>El elememento <code class="docutils literal"><span class="pre">moneda</span></code> desaparece y su texto se ha puesto al lado de la cantidad que hay en <code class="docutils literal"><span class="pre">saldoactual</span></code>.</li>
<li>En el elemento <code class="docutils literal"><span class="pre">fondo</span></code> se ha quitado el elemento <code class="docutils literal"><span class="pre">datos</span></code>.</li>
<li>El elemento <code class="docutils literal"><span class="pre">cuentaasociada</span></code> ha pasado a ser un atributo.</li>
</ol>
</div>
<div class="section" id="solucion-paso-a-paso">
<h3>Solución paso a paso<a class="headerlink" href="#solucion-paso-a-paso" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Empecemos por crear una hoja muy básica, que busque el elemento raíz y devuelva como salida el elemento <code class="docutils literal"><span class="pre">datos</span></code> (que va a ser la nueva raíz)</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Si probamos dicho XSLT aplicándolo al XML original obtendremos esto:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos/&gt;</span>
</pre></div>
</div>
<p>No pasa nada porque se obtenga el elemento raíz vacío, el programa de transformación lo hace para ahorrar tiempo y bytes.</p>
<p>Una vez que hemos cambiado el elemento raíz tenemos que generar dos elementos más que agrupen los elementos <code class="docutils literal"><span class="pre">cuenta</span></code> y los elementos <code class="docutils literal"><span class="pre">fondo</span></code>. Para ello, basta con escribirlos como muestra la siguiente hoja de estilo.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Ahora tenemos que ir buscando todos los elementos <code class="docutils literal"><span class="pre">cuenta</span></code> y meterlos dentro de <code class="docutils literal"><span class="pre">cuentas</span></code>. Despues resolveremos el problema de los fondos. Para recorrer elementos necesitamos un bucle <code class="docutils literal"><span class="pre">for-each</span></code>. Como la plantilla ya nos ha situado en la raíz necesitaremos que el bucle no vaya dando cada uno de los elementos <code class="docutils literal"><span class="pre">listado/cuenta</span></code>. Es decir, le pedimos al bucle que se meta en el elemento hijo <code class="docutils literal"><span class="pre">listado</span></code> y nos vaya dando cada uno de los elementos <code class="docutils literal"><span class="pre">cuenta</span></code> que hay dentro. Un posible bucle sería este:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Que al pasárselo a nuestros datos nos da esto:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos&gt;</span>
  <span class="nt">&lt;cuentas&gt;</span>
    <span class="nt">&lt;cuenta/&gt;</span>
    <span class="nt">&lt;cuenta/&gt;</span>
  <span class="nt">&lt;/cuentas&gt;</span>
  <span class="nt">&lt;fondos/&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
<p>Como puede verse, la plantilla genera dos elementos <code class="docutils literal"><span class="pre">cuenta</span></code>, uno por cada <code class="docutils literal"><span class="pre">cuenta</span></code> que nos da el bucle. Obsérvese que podríamos haber hecho esto para tener un nombre de elemento distinto, <strong>y este es el «truco» para poder cambiar de nombre un elemento</strong> :</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;otroelemento&gt;&lt;/otroelemento&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Sigamos con el problema original: ya hemos creado un elemento <code class="docutils literal"><span class="pre">cuentas</span></code> que lleva dentro un elemento <code class="docutils literal"><span class="pre">cuenta</span></code> para cada una de las cuentas originales. Ahora en dicho elemento <code class="docutils literal"><span class="pre">cuenta</span></code> vamos a meter dentro un atributo llamado <code class="docutils literal"><span class="pre">dnititular</span></code> usando la etiqueta <code class="docutils literal"><span class="pre">xsl:attribute</span></code> que debe ir <strong>dentro del elemento al que le queramos poner el atributo y además al principio</strong>. Si queremos varios atributos no pasa nada podemos ponerlos todos dentro del elemento pero recordando ponerlos al principio.</p>
<p>Así, el código siguiente nos fabrica el atributo.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="c">&lt;!--Esto añade el atributo dnititular a cuenta--&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>10<span class="nt">&lt;/xsl:attribute&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Pero hay un problema, todas las cuentas tienen el <code class="docutils literal"><span class="pre">dnititular</span></code> a 10. Necesitamos la etiqueta <code class="docutils literal"><span class="pre">value-of</span></code> que nos permite <strong>extraer el contenido de un elemento o atributo</strong>, en este caso queremos extrar el valor del atributo <code class="docutils literal"><span class="pre">dni</span></code> que está dentro del elemento <code class="docutils literal"><span class="pre">titular</span></code>. Esto se hace con <code class="docutils literal"><span class="pre">titular/&#64;dni</span></code> que significa «extraer el atributo dni que debe estar dentro del elemento titular».</p>
<p>Así, el código siguiente:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Nos devuelve como resultado:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos&gt;</span>
  <span class="nt">&lt;cuentas&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/cuentas&gt;</span>
  <span class="nt">&lt;fondos/&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
<p>El paso siguiente va a ser crear el elemento <code class="docutils literal"><span class="pre">titular</span></code> que también se llama <code class="docutils literal"><span class="pre">titular</span></code> en el archivo original. Para ello lo metemos dentro de <code class="docutils literal"><span class="pre">cuenta</span></code> y permitiendo que la creación del atributo <code class="docutils literal"><span class="pre">dnititular</span></code> se quede al principio.</p>
<p>El código XSLT es este</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Que genera el siguiente resultado:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos&gt;</span>
  <span class="nt">&lt;cuentas&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Ramon Perez<span class="nt">&lt;/titular&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Carmen Diaz<span class="nt">&lt;/titular&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
  <span class="nt">&lt;/cuentas&gt;</span>
  <span class="nt">&lt;fondos/&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
<p>Ahora vamos a crear el elemento <code class="docutils literal"><span class="pre">saldoactual</span></code>. Dentro de ese elemento debemos escribir el texto que ya tuviese el <code class="docutils literal"><span class="pre">saldoactual</span></code> antiguo y escribiendo al lado el atributo <code class="docutils literal"><span class="pre">moneda</span></code>.</p>
<p>El código necesario es este</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                    <span class="c">&lt;!--Creamos el saldo actual--&gt;</span>
                    <span class="nt">&lt;saldoactual&gt;</span>
                        <span class="c">&lt;!--Y metemos dentro la cantidad que tuviese</span>
<span class="c">                        el fichero original...--&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual&quot;</span><span class="nt">/&gt;</span>
                        <span class="c">&lt;!--Y extraemos la moneda...--&gt;</span>
                         <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual/@moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/saldoactual&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Y el resultado es este:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos&gt;</span>
  <span class="nt">&lt;cuentas&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Ramon Perez<span class="nt">&lt;/titular&gt;</span>
      <span class="nt">&lt;saldoactual&gt;</span>12000euros<span class="nt">&lt;/saldoactual&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Carmen Diaz<span class="nt">&lt;/titular&gt;</span>
      <span class="nt">&lt;saldoactual&gt;</span>1900euros<span class="nt">&lt;/saldoactual&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
  <span class="nt">&lt;/cuentas&gt;</span>
  <span class="nt">&lt;fondos/&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
<p>Por último, añadamos la fecha de creación. En el fichero original se llama <code class="docutils literal"><span class="pre">fechacreación</span></code> y en el fichero final se llama <code class="docutils literal"><span class="pre">creación</span></code> y además va como primer elemento. El XSLT sería este:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento &quot;creación&quot; que en</span>
<span class="c">                    realidad contiene el texto del elemento</span>
<span class="c">                    &quot;fechacreación&quot; original--&gt;</span>
                    <span class="nt">&lt;creacion&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;fechacreacion&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/creacion&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                    <span class="c">&lt;!--Creamos el saldo actual--&gt;</span>
                    <span class="nt">&lt;saldoactual&gt;</span>
                        <span class="c">&lt;!--Y metemos dentro la cantidad que tuviese</span>
<span class="c">                        el fichero original...--&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual&quot;</span><span class="nt">/&gt;</span>
                        <span class="c">&lt;!--Y extraemos la moneda...--&gt;</span>
                         <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual/@moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/saldoactual&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Que genera el resultado siguiente:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos&gt;</span>
  <span class="nt">&lt;cuentas&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;creacion&gt;</span>13-abril-2012<span class="nt">&lt;/creacion&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Ramon Perez<span class="nt">&lt;/titular&gt;</span>
      <span class="nt">&lt;saldoactual&gt;</span>12000euros<span class="nt">&lt;/saldoactual&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;creacion&gt;</span>15-febrero-2011<span class="nt">&lt;/creacion&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Carmen Diaz<span class="nt">&lt;/titular&gt;</span>
      <span class="nt">&lt;saldoactual&gt;</span>1900euros<span class="nt">&lt;/saldoactual&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
  <span class="nt">&lt;/cuentas&gt;</span>
  <span class="nt">&lt;fondos/&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
<p>Con esto, la parte de las <code class="docutils literal"><span class="pre">cuentas</span></code> ya está hecha. Ahora queda lo siguiente</p>
<ol class="arabic simple">
<li>Hacer un elemento <code class="docutils literal"><span class="pre">fondos</span></code> con un bucle que vaya generando elementos <code class="docutils literal"><span class="pre">fondo</span></code>.</li>
<li>Poner en el <code class="docutils literal"><span class="pre">fondo</span></code> el atributo <code class="docutils literal"><span class="pre">cuentaasociada</span></code>.</li>
<li>Crear el elemento <code class="docutils literal"><span class="pre">cantidaddepositada</span></code>.</li>
<li>Crear el elemento moneda.</li>
</ol>
<p>Vamos con el paso 1 <em>«crear el elemento fondos»</em></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento &quot;creación&quot; que en</span>
<span class="c">                    realidad contiene el texto del elemento</span>
<span class="c">                    &quot;fechacreación&quot; original--&gt;</span>
                    <span class="nt">&lt;creacion&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;fechacreacion&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/creacion&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                    <span class="c">&lt;!--Creamos el saldo actual--&gt;</span>
                    <span class="nt">&lt;saldoactual&gt;</span>
                        <span class="c">&lt;!--Y metemos dentro la cantidad que tuviese</span>
<span class="c">                        el fichero original...--&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual&quot;</span><span class="nt">/&gt;</span>
                        <span class="c">&lt;!--Y extraemos la moneda...--&gt;</span>
                         <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual/@moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/saldoactual&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/fondo&quot;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--Paso 1: crear un fondo por cada fondo original--&gt;</span>
                <span class="nt">&lt;fondo&gt;</span>

                <span class="nt">&lt;/fondo&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Ahora el paso 2: <em>poner el atributo «cuentaasociada»</em>. El XSLT sería así:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento &quot;creación&quot; que en</span>
<span class="c">                    realidad contiene el texto del elemento</span>
<span class="c">                    &quot;fechacreación&quot; original--&gt;</span>
                    <span class="nt">&lt;creacion&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;fechacreacion&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/creacion&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                    <span class="c">&lt;!--Creamos el saldo actual--&gt;</span>
                    <span class="nt">&lt;saldoactual&gt;</span>
                        <span class="c">&lt;!--Y metemos dentro la cantidad que tuviese</span>
<span class="c">                        el fichero original...--&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual&quot;</span><span class="nt">/&gt;</span>
                        <span class="c">&lt;!--Y extraemos la moneda...--&gt;</span>
                         <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual/@moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/saldoactual&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/fondo&quot;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--Paso 1: crear un fondo por cada fondo original--&gt;</span>
                <span class="nt">&lt;fondo&gt;</span>
                    <span class="c">&lt;!--Paso 2, crear el atributo cuentaasociada--&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;cuentaasociada&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;cuentaasociada&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>

                <span class="nt">&lt;/fondo&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Con el XSLT siguiente conseguimos el paso 3: <em>«crear el elemento cantidaddepositada»</em></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento &quot;creación&quot; que en</span>
<span class="c">                    realidad contiene el texto del elemento</span>
<span class="c">                    &quot;fechacreación&quot; original--&gt;</span>
                    <span class="nt">&lt;creacion&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;fechacreacion&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/creacion&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                    <span class="c">&lt;!--Creamos el saldo actual--&gt;</span>
                    <span class="nt">&lt;saldoactual&gt;</span>
                        <span class="c">&lt;!--Y metemos dentro la cantidad que tuviese</span>
<span class="c">                        el fichero original...--&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual&quot;</span><span class="nt">/&gt;</span>
                        <span class="c">&lt;!--Y extraemos la moneda...--&gt;</span>
                         <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual/@moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/saldoactual&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/fondo&quot;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--Paso 1: crear un fondo por cada fondo original--&gt;</span>
                <span class="nt">&lt;fondo&gt;</span>
                    <span class="c">&lt;!--Paso 2, crear el atributo cuentaasociada--&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;cuentaasociada&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;cuentaasociada&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Paso 3, crear el elemento cantidaddepositada--&gt;</span>
                    <span class="nt">&lt;cantidaddepositada&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;datos/cantidaddepositada&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/cantidaddepositada&gt;</span>
                <span class="nt">&lt;/fondo&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Y por último el paso 4 «crear el elemento moneda». El XSLT sería algo así:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;datos&gt;</span>
        <span class="nt">&lt;cuentas&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/cuenta&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;cuenta&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;dnititular&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular/@dni&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento &quot;creación&quot; que en</span>
<span class="c">                    realidad contiene el texto del elemento</span>
<span class="c">                    &quot;fechacreación&quot; original--&gt;</span>
                    <span class="nt">&lt;creacion&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;fechacreacion&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/creacion&gt;</span>
                    <span class="c">&lt;!--Creamos el elemento titular y metemos</span>
<span class="c">                    dentro del valor original del titular--&gt;</span>
                    <span class="nt">&lt;titular&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;titular&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/titular&gt;</span>
                    <span class="c">&lt;!--Creamos el saldo actual--&gt;</span>
                    <span class="nt">&lt;saldoactual&gt;</span>
                        <span class="c">&lt;!--Y metemos dentro la cantidad que tuviese</span>
<span class="c">                        el fichero original...--&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual&quot;</span><span class="nt">/&gt;</span>
                        <span class="c">&lt;!--Y extraemos la moneda...--&gt;</span>
                         <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;saldoactual/@moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/saldoactual&gt;</span>
                <span class="nt">&lt;/cuenta&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/cuentas&gt;</span>
        <span class="nt">&lt;fondos&gt;</span>
            <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">&quot;listado/fondo&quot;</span><span class="nt">&gt;</span>
                <span class="c">&lt;!--Paso 1: crear un fondo por cada fondo original--&gt;</span>
                <span class="nt">&lt;fondo&gt;</span>
                    <span class="c">&lt;!--Paso 2, crear el atributo cuentaasociada--&gt;</span>
                    <span class="nt">&lt;xsl:attribute</span> <span class="na">name=</span><span class="s">&quot;cuentaasociada&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;cuentaasociada&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/xsl:attribute&gt;</span>
                    <span class="c">&lt;!--Paso 3, crear el elemento cantidaddepositada--&gt;</span>
                    <span class="nt">&lt;cantidaddepositada&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;datos/cantidaddepositada&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/cantidaddepositada&gt;</span>
                    <span class="c">&lt;!--Paso 4:Crear el elemento moneda--&gt;</span>
                    <span class="nt">&lt;moneda&gt;</span>
                        <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">&quot;datos/moneda&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/moneda&gt;</span>
                <span class="nt">&lt;/fondo&gt;</span>
            <span class="nt">&lt;/xsl:for-each&gt;</span>
        <span class="nt">&lt;/fondos&gt;</span>
    <span class="nt">&lt;/datos&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></div>
</div>
<p>Si probamos el XSLT anterior veremos que efectivamente conseguimos transformar el fichero original en el fichero resultado que nos piden, que es el siguiente:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;datos&gt;</span>
  <span class="nt">&lt;cuentas&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;5671001D&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;creacion&gt;</span>13-abril-2012<span class="nt">&lt;/creacion&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Ramon Perez<span class="nt">&lt;/titular&gt;</span>
      <span class="nt">&lt;saldoactual&gt;</span>12000euros<span class="nt">&lt;/saldoactual&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
    <span class="nt">&lt;cuenta</span> <span class="na">dnititular=</span><span class="s">&quot;39812341C&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;creacion&gt;</span>15-febrero-2011<span class="nt">&lt;/creacion&gt;</span>
      <span class="nt">&lt;titular&gt;</span>Carmen Diaz<span class="nt">&lt;/titular&gt;</span>
      <span class="nt">&lt;saldoactual&gt;</span>1900euros<span class="nt">&lt;/saldoactual&gt;</span>
    <span class="nt">&lt;/cuenta&gt;</span>
  <span class="nt">&lt;/cuentas&gt;</span>
  <span class="nt">&lt;fondos&gt;</span>
    <span class="nt">&lt;fondo</span> <span class="na">cuentaasociada=</span><span class="s">&quot;20-A&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;cantidaddepositada&gt;</span>20000<span class="nt">&lt;/cantidaddepositada&gt;</span>
      <span class="nt">&lt;moneda&gt;</span>Euros<span class="nt">&lt;/moneda&gt;</span>
    <span class="nt">&lt;/fondo&gt;</span>
    <span class="nt">&lt;fondo</span> <span class="na">cuentaasociada=</span><span class="s">&quot;21-DX&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;cantidaddepositada&gt;</span>4800<span class="nt">&lt;/cantidaddepositada&gt;</span>
      <span class="nt">&lt;moneda&gt;</span>Dolares<span class="nt">&lt;/moneda&gt;</span>
    <span class="nt">&lt;/fondo&gt;</span>
  <span class="nt">&lt;/fondos&gt;</span>
<span class="nt">&lt;/datos&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Tabla de Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">Anexo: ejercicios sobre XSLT</a><ul>
<li><a class="reference internal" href="#fichero-origen">Fichero origen</a></li>
<li><a class="reference internal" href="#generacion-de-lista-con-puntos">Generación de lista con puntos</a></li>
<li><a class="reference internal" href="#recuperacion-de-elementos-pesados">Recuperación de elementos pesados</a></li>
<li><a class="reference internal" href="#productos-del-edificio-b">Productos del edificio B</a></li>
<li><a class="reference internal" href="#tabla-de-localizaciones">Tabla de localizaciones</a></li>
<li><a class="reference internal" href="#tablas-con-edificios-separados">Tablas con edificios separados</a></li>
<li><a class="reference internal" href="#productos-del-aula-6">Productos del aula 6</a></li>
<li><a class="reference internal" href="#id1">Productos del edificio B</a></li>
<li><a class="reference internal" href="#condiciones-multiples-peso-ligero-y-edificio-a">Condiciones múltiples: peso ligero y edificio A</a></li>
<li><a class="reference internal" href="#ejercicio-de-examen-xslt">Ejercicio de examen XSLT</a></li>
<li><a class="reference internal" href="#transformacion-de-un-xml-bancario">Transformación de un XML bancario</a><ul>
<li><a class="reference internal" href="#analisis-del-problema">Análisis del problema</a></li>
<li><a class="reference internal" href="#solucion-paso-a-paso">Solución paso a paso</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../formularios/anexo_formularios.html" title="capítulo anterior">Anexo: ejercicios sobre formularios</a></li>
      <li>Next: <a href="../xpath/anexo_ejercicios_xpath.html" title="próximo capítulo">Anexo: Ejercicios de XPath</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/ejercicios/xslt/anexo_ejercicios_xslt.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Ir a" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Oscar Gomez.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/ejercicios/xslt/anexo_ejercicios_xslt.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>